<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Head -->
    <%- include('partials/_head') %>
  </head>

  <body>
    <!-- Navbar -->
    <%- include('partials/_navbar') %>

    <div class="background-image">
      <!-- Orders List -->
      <div id="orders-table" class="card-body">
        <div class="orders container shadow-lg p-4 rounded">
          <div class="container px-3 d-flex align-items-center justify-content-between">
            <h2>My Orders</h2>
            <button type="button" class="close pr-4">
              <span aria-hidden="true"><a class="orderCloseBtn" href="/bubbleteas">&times;</a></span>
            </button>
          </div>
          <div class="orderTable">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col" class="align-middle">Order #</th>
                  <th scope="col" class="align-middle">Total Price</th>
                  <th scope="col" class="align-middle">Quantity</th>
                  <th scope="col" class="align-middle">Ordered On</th>
                  <th scope="col" class="align-middle">Status</th>
                  <th scope="col" class="align-middle">ETA (minutes)</th>
                </tr>
              </thead>
              <tbody>
                <% for(const order of orders) { %>
                <tr>
                  <td class="align-middle"><%= order.id %></td>
                  <td class="align-middle">$ <%=order.total_cost / 100 %></td>
                  <td class="align-middle"><%= order.total_items %></td>
                  <td class="align-middle">
                    <%= order.created_at.getFullYear() + "/" +
                    (order.created_at.getMonth() + 1) + "/" +
                    order.created_at.getDate() %>
                  </td>
                  <td class="align-middle">
                    <!-- Display order submitted, in progress or completed progress bar depending on order -->
                    <% if (order.status === 'COMPLETED') { %>
                    <div class="progress">
                      <div
                        class="progress-bar progress-bar-striped bg-success"
                        role="progressbar"
                        style="width: 100%"
                        aria-valuenow="25"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    Complete <% } else if (order.status === 'IN PROGRESS') { %>
                    <div class="progress">
                      <div
                        class="progress-bar progress-bar-striped progress-bar-animated bg-warning"
                        role="progressbar"
                        style="width: 50%"
                        aria-valuenow="25"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    Brewing in Progress... <% } else { %>
                    <div class="progress">
                      <div
                        class="progress-bar progress-bar-striped progress-bar-animated"
                        role="progressbar"
                        style="width: 25%"
                        aria-valuenow="25"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    Order Submitted <% } %>
                  </td>
                  <td class="align-middle"><%= order.eta %></td>
                </tr>
                <% } %>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <%- include('partials/_footer') %>

      <!-- jQuery and Bootstrap Bundle -->
      <script
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous"
      ></script>
      <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
        crossorigin="anonymous"
      ></script>
    </div>
  </body>
</html>
